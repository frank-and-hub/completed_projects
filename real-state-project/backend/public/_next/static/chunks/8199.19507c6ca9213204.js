(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8199],{68199:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return F}});var t=n(57437),i=n(22959),a=n(37484),o=n(46341),s=n(42982),r=n(60380),d=n(2874),u=n(91964),c=n(2265);n(75081);var g=n(83464),p=n(81296);let v=null,h=e=>(v&&v.cancel("Request canceled due to new request."),v=g.Z.CancelToken.source(),(0,p.g_)("property-map",e,{cancelToken:v.token}));var m=n(40525),x=n(28700),f=n(90334),b=n(21770),j=n(71632),w=["places","geocoding"],y=()=>{let{isShowMap:e}=(0,m.CG)(e=>null==e?void 0:e.userReducer),l=(0,m.TL)(),{data:n,mutate:t,isPending:i}=(0,b.useMutation)({mutationFn:h,onSuccess:n=>{var t,i;e!==(null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.is_show_map)&&l((0,x.iU)(null==n?void 0:null===(i=n.data)||void 0===i?void 0:i.is_show_map))}}),{isLoaded:a}=(0,u.Db)({googleMapsApiKey:"AIzaSyCLXi82PTPRmZSgvRgJSDD6wtgO5MzHxpk",libraries:w,id:"__googleMapsScriptId"}),[o,s]=(0,c.useState)(null),r=(0,c.useRef)(null),[d,g]=(0,c.useState)([]),[p,v]=(0,c.useState)(null),[y,S]=(0,c.useState)(null);(0,c.useEffect)(()=>{var e,l;t({distance:"50",latitude:String(null!==(e=null==o?void 0:o.lat)&&void 0!==e?e:""),longitude:String(null!==(l=null==o?void 0:o.lng)&&void 0!==l?l:"")})},[o]);let{data:C,isLoading:_}=(0,j.useQuery)({queryKey:["mapMarkerData",o],queryFn:()=>{var e,l;return h({latitude:String(null!==(e=null==o?void 0:o.lat)&&void 0!==e?e:""),distance:"50",longitude:String(null!==(l=null==o?void 0:o.lng)&&void 0!==l?l:"")})}});return(0,c.useEffect)(()=>{var e;(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.lat_lng)&&g(e=>{var l;let n=new Map;return[...e,...null==C?void 0:null===(l=C.data)||void 0===l?void 0:l.lat_lng].forEach(e=>{n.set(e.id,e)}),Array.from(n.values())})},[C]),{isShowMap:!0,debouncedHandleBoundsChanged:(0,f.y)(()=>{let e=r.current;if(e){let l=e.getCenter();l&&s({lat:null==l?void 0:l.lat(),lng:null==l?void 0:l.lng()})}},300),onLoad:e=>{r.current=e},setId:S,id:y,selected:p,setSelected:v,isLoaded:a,markers:d,isLoading:_,mapRef:r}},S=n(28107),C=n(74904),_=n(91443),k=n(27648),z=function(e){var l,n,i,a;let{setSelected:o,setId:s,selected:r,timerRef:d}=e;return(0,t.jsx)(u.nx,{options:{headerDisabled:!0,headerContent:"bhjh"},onCloseClick:()=>{o(null),s(null)},position:{lat:Number(r.lat),lng:Number(r.lng)},children:(0,t.jsx)(k.default,{target:"_blank",href:"/property-detail?property_id=".concat(null==r?void 0:r.id,"&updateKey=").concat(null!==(a=null==r?void 0:r.type)&&void 0!==a?a:"internal"),children:(0,t.jsxs)("div",{className:"detail_card",children:[(0,t.jsx)(_.Z,{style:{position:"absolute",right:8,top:5,cursor:"pointer"},onClick:e=>{null==e||e.stopPropagation(),e.preventDefault(),o(null),s(null)}}),(0,t.jsx)("div",{className:"image_container",children:(0,t.jsx)(C.E,{src:null==r?void 0:null===(l=r.main_image)||void 0===l?void 0:l.image,alt:"Image",width:170,height:120})}),(0,t.jsxs)("div",{className:"detail_right_container",children:[(0,t.jsxs)("h3",{children:[(0,S.fm)(null==r?void 0:r.title)," "]}),(0,t.jsxs)("h2",{children:["Price : ",null===(n=r.financials)||void 0===n?void 0:n.price," ",null==r?void 0:null===(i=r.financials)||void 0===i?void 0:i.currency]}),(null==r?void 0:r.address)&&(0,t.jsx)("p",{children:null==r?void 0:r.address})]})]})})})};let N={lat:-30.5595,lng:22.9375},M={minZoom:3,fullscreenControl:!0,zoom:2};var F=()=>{let{isShowMap:e,debouncedHandleBoundsChanged:l,id:n,onLoad:g,selected:p,setId:v,setSelected:h,isLoaded:x,markers:f,isLoading:b}=y(),j=(0,m.CG)(e=>{var l;return null===(l=e.userReducer.userDetail)||void 0===l?void 0:l.location}),w=(0,c.useMemo)(()=>({lat:(null==j?void 0:j.lat)?Number(j.lat):null==N?void 0:N.lat,lng:(null==j?void 0:j.lng)?Number(j.lng):null==N?void 0:N.lng}),[j]);return e?(0,t.jsx)("div",{className:"map_container",children:(0,t.jsxs)(o.Container,{size:"lg",children:[(0,t.jsxs)(s.Flex,{align:"center",justify:"center",direction:"column",pb:30,children:[(0,t.jsx)(r.Box,{className:"heading_box_sec",children:(0,t.jsx)("p",{children:"Find On Map"})}),(0,t.jsx)(i.default,{mb:"20px",mt:"sm",ml:"md",fw:"600",size:"30px",children:"Explore properties"}),(0,t.jsx)(i.default,{size:"14px",children:"This map shows properties available now and updates constantlyâ€”log your needs for faster matching."})]}),x?(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)(u.b6,{options:M,mapContainerStyle:{width:"100%",height:"400px",borderRadius:20},center:w,zoom:6,onLoad:e=>{g(e)},onClick:()=>{h(null),v(null)},onIdle:()=>{l()},children:(0,t.jsx)(u.XL,{styles:[{url:"/assets/images/markerCluster.png",height:40,width:40,textColor:"#fff",textSize:14},{url:"/assets/images/markerCluster.png",height:50,width:50,textColor:"#fff",textSize:14},{url:"/assets/images/markerCluster.png",height:50,width:50,textColor:"#fff",textSize:14}],children:e=>(0,t.jsx)(t.Fragment,{children:(null==f?void 0:f.length)?null==f?void 0:f.map((l,i)=>(0,t.jsx)(u.Jx,{position:{lat:Number(null==l?void 0:l.lat),lng:Number(null==l?void 0:l.lng)},clusterer:e,icon:a.Z?{url:"https://images.ctfassets.net/3prze68gbwl1/assetglossary-17su9wok1ui0z7w/c4c4bdcdf0d0f86447d3efc450d1d081/map-marker.png",scaledSize:new window.google.maps.Size(40,40)}:{url:"/assets/images/MapIcon.svg",scaledSize:new window.google.maps.Size(40,40)},onMouseOver:()=>{h(l),v(i)},onClick:()=>{h(l),v(i)},children:p&&n===i&&(0,t.jsx)(z,{selected:p,setId:v,setSelected:h})},null==l?void 0:l.id)):null})})}),b&&(0,t.jsx)(d.a,{type:"dots",size:32,style:{position:"absolute",zIndex:2,background:"#FFF",top:"5%",right:"50%",transform:"translate(50%, 50%)",width:80,borderRadius:20,boxShadow:"rgba(0, 0, 0, 0.35) 0px 5px 15px"}})]}):(0,t.jsx)(d.a,{size:28,style:{position:"absolute",top:"70%",left:"50%",transform:"translate(50%, 0)"}})]})}):null}},75081:function(){}}]);